<UserControl xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:Highbyte.DotNet6502.App.Avalonia.Core.ViewModels"
        x:Class="Highbyte.DotNet6502.App.Avalonia.Core.Views.ErrorUserControl"
        x:DataType="vm:ErrorViewModel">


    <Border BorderBrush="#F44336"
            BorderThickness="2"
            CornerRadius="4"
            Background="#3A3A3A"
            Margin="8"
            Padding="12">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Error icon/title -->
            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,12">
                <Ellipse Width="24" Height="24" Fill="#F44336" Margin="0,0,8,0"/>
                <TextBlock Text="ERROR!" Classes="error" VerticalAlignment="Center"/>
            </StackPanel>

            <!-- Main error message -->
            <TextBox Grid.Row="1"
                     x:Name="ErrorMessageTextBox"
                     Text="{Binding ErrorMessage}"
                     TextWrapping="Wrap"
                     Classes="h2"
                     Margin="0,0,0,12"
                     IsReadOnly="True"
                     BorderThickness="0"
                     Background="#1A000000"
                     Foreground="White"/>

            <!-- Exception details -->
            <ScrollViewer Grid.Row="2"
                          x:Name="ExceptionDetailsScrollViewer"
                          Margin="0,0,0,12"
                          IsVisible="{Binding ShowDetails}"
                          HorizontalScrollBarVisibility="Auto"
                          VerticalScrollBarVisibility="Auto"
                          MaxHeight="200">
                <StackPanel>
                    <TextBlock Text="Exception Details:"
                               Foreground="{DynamicResource WarningColor}"
                               Margin="0,0,0,4"/>
                    <TextBox Text="{Binding ExceptionDetails}"
                             TextWrapping="Wrap"
                             Classes="monospace"
                             Background="#1A000000"
                             MaxWidth="420"
                             IsReadOnly="True"
                             BorderThickness="1"
                             BorderBrush="#333333"
                             AcceptsReturn="True"/>
                </StackPanel>
            </ScrollViewer>

            <!-- Show Details Button (only visible if there's an exception) -->
            <StackPanel Grid.Row="3"
                        Orientation="Horizontal"
                        HorizontalAlignment="Center"
                        Margin="0,0,0,12"
                        IsVisible="{Binding HasException}">
                <Button x:Name="ShowDetailsButton"
                        Content="{Binding ShowDetailsButtonText}"
                        Width="120"
                        Height="30"
                        Classes="text"
                        Command="{Binding ShowExceptionDetailsCommand}"/>
            </StackPanel>

            <!-- Buttons -->
            <StackPanel Grid.Row="4"
                        Orientation="Horizontal"
                        HorizontalAlignment="Center"
                        Spacing="10">
                <Button x:Name="ContinueButton"
                        Content="Continue"
                        Width="100"
                        Height="35"
                        Classes="primary"
                        IsDefault="True"
                        Command="{Binding ContinueCommand}"/>
                <!--<Button x:Name="ContinueButton"
                        Content="Continue"
                        Width="100"
                        Height="35"
                        Classes="primary"
                        IsDefault="True"
                        Click="ContinueButton_Click"/>-->
                <Button x:Name="ExitButton"
                        Content="Exit"
                        Width="100"
                        Height="35"
                        Classes="danger"
                        Command="{Binding ExitCommand}"
                        IsVisible="{Binding !IsRunningInWebAssembly}"/>
            </StackPanel>
        </Grid>
    </Border>
</UserControl>