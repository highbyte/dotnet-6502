<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:Highbyte.DotNet6502.App.Avalonia.Core.ViewModels"
             x:Class="Highbyte.DotNet6502.App.Avalonia.Core.Views.C64MenuView"
             x:DataType="vm:C64MenuViewModel"
             Focusable="False">

    <!-- DataContext will be set from constructor via DI -->

    <UserControl.Styles>
        <!-- Include non-focusable styles -->
        <StyleInclude Source="avares://Highbyte.DotNet6502.App.Avalonia.Core/Styles/NonFocusableStyles.axaml"/>
    </UserControl.Styles>

    <!-- C64 Specific actions and settings -->
    <StackPanel Classes="spacing-medium">
        <TextBlock Text="Commodore 64"
                   Classes="h2" />

        <!-- Copy/Paste buttons -->
        <Grid Classes="spacing-tight">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Button Grid.Column="0"
                    Content="Copy"
                    Command="{Binding CopyBasicSourceCommand}"
                    Classes="compact"/>
            <Button Grid.Column="1"
                    Content="Paste"
                    Command="{Binding PasteTextCommand}"
                    Classes="compact"/>
        </Grid>

        <!-- AI Basic coding assistant -->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <CheckBox Grid.Column="0"
                      Content="AI Basic (F9)"
                      Classes=""
                      IsChecked="{Binding BasicCodingAssistantEnabled}"
                      IsEnabled="{Binding BasicCodingAssistantAvailable}"/>
            <Button Grid.Column="2"
                    Content="i"
                    Classes="info"
                    Click="OpenBasicAssistantInfo_Click"/>
        </Grid>

        <!-- Disk Drive & D64 images -->
        <StackPanel>
            <Button Name="DiskSectionHeader"
                    Content="▼ Disk Drive &amp; .D64 images"
                    Classes="section-toggle"
                    Click="ToggleDiskSection_Click"/>

            <Border Name="DiskSectionContent" Classes="collapsible-content">
                <StackPanel Classes="spacing-small">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Button Grid.Column="0"
                                Content="{Binding DiskToggleButtonText}"
                                Name="DiskToggleButton"
                                Command="{Binding ToggleDiskImageCommand}"
                                Classes="small"/>
                        <Button Grid.Column="1"
                                Content="i"
                                Classes="info"
                                Click="OpenDiskInfo_Click"/>
                    </Grid>

                    <TextBlock Text="Download &amp; Run .D64 programs"
                               Classes="small secondary-text"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <ComboBox Grid.Column="0"
                                  ItemsSource="{Binding PreloadedD64Programs}"
                                  SelectedValue="{Binding SelectedPreloadedDisk}"
                                  DisplayMemberBinding="{Binding Value}"
                                  SelectedValueBinding="{Binding Key}"
                                  IsEnabled="true"
                                  Classes="small"
                                  MinWidth="60"/>
                        <Button Grid.Column="1"
                                Content="i"
                                Classes="info"
                                Click="OpenDiskInfo_Click"/>
                    </Grid>

                    <Button Content="Download &amp; Run"
                            Classes="primary small"
                            Command="{Binding LoadPreloadedDiskCommand}"
                            IsVisible="{Binding SelectedPreloadedDisk, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>

                    <TextBlock Text="Download D64 disk image and auto-run the program on it."
                               Classes="small secondary-text"
                               TextWrapping="Wrap"
                               IsVisible="{Binding SelectedPreloadedDisk, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                </StackPanel>
            </Border>
        </StackPanel>

        <!-- Load/Save -->
        <StackPanel>
            <Button Name="LoadSaveSectionHeader"
                    Content="▼ Load/Save"
                    Classes="section-toggle"
                    Click="ToggleLoadSaveSection_Click"/>

            <Border Name="LoadSaveSectionContent" Classes="collapsible-content" IsVisible="False">
                <StackPanel Classes="spacing-small">
                    <TextBlock Text="Load/save .prg files"
                               Classes="small secondary-text"/>

                    <Grid Classes="spacing-tight">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Button Grid.Column="0"
                                Content="Load Basic"
                                IsEnabled="{Binding IsFileOperationEnabled}"
                                Click="LoadBasicFile_Click"
                                Classes="small"/>
                        <Button Grid.Column="1"
                                Content="Save Basic"
                                IsEnabled="{Binding IsFileOperationEnabled}"
                                Click="SaveBasicFile_Click"
                                Classes="small"/>
                    </Grid>

                    <Button Content="Load &amp; start binary"
                            Classes="primary small"
                            IsEnabled="{Binding IsFileOperationEnabled}"
                            Click="LoadBinaryFile_Click"/>

                    <TextBlock Text="Assembly example files"
                               Classes="small secondary-text"/>
                    <Grid Height="28">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <ComboBox Grid.Column="0"
                                  ItemsSource="{Binding AssemblyExamples}"
                                  SelectedValue="{Binding SelectedAssemblyExample}"
                                  DisplayMemberBinding="{Binding Value}"
                                  SelectedValueBinding="{Binding Key}"
                                  IsEnabled="{Binding IsFileOperationEnabled}"
                                  Classes="small"
                                  VerticalAlignment="Stretch"
                                  MinWidth="60"/>
                        <Button Grid.Column="1"
                                Content="Load &amp; start"
                                VerticalAlignment="Stretch"
                                Classes="primary small"/>
                    </Grid>

                    <TextBlock Text="Basic example files"
                               Classes="small secondary-text"/>
                    <Grid Height="28">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <ComboBox Grid.Column="0"
                                  ItemsSource="{Binding BasicExamples}"
                                  SelectedValue="{Binding SelectedBasicExample}"
                                  DisplayMemberBinding="{Binding Value}"
                                  SelectedValueBinding="{Binding Key}"
                                  IsEnabled="{Binding IsFileOperationEnabled}"
                                  Classes="small"
                                  VerticalAlignment="Stretch"
                                  MinWidth="60"/>
                        <Button Grid.Column="1"
                                Content="Load"
                                VerticalAlignment="Stretch"
                                Classes="primary small"
                                Command="{Binding LoadBasicExampleCommand}"/>
                    </Grid>
                </StackPanel>
            </Border>
        </StackPanel>

        <!-- Configuration -->
        <StackPanel>
            <Button Name="ConfigSectionHeader"
                    Content="▼ Configuration"
                    Classes="section-toggle"
                    Click="ToggleConfigSection_Click"/>

            <Border Name="ConfigSectionContent" Classes="collapsible-content" IsVisible="False">
                <StackPanel Classes="spacing-small">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0"
                                   Text="Active joystick:"
                                   Classes="small secondary-text"/>
                        <ComboBox Grid.Column="1"
                                  ItemsSource="{Binding AvailableJoysticks}"
                                  SelectedItem="{Binding CurrentJoystick}"
                                  Classes="small"
                                  MinWidth="30"/>
                    </Grid>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <CheckBox Grid.Column="0"
                                  Content="Joystick KB:"
                                  Classes="small"
                                  IsChecked="{Binding JoystickKeyboardEnabled}"/>
                        <ComboBox Grid.Column="1"
                                  ItemsSource="{Binding AvailableJoysticks}"
                                  SelectedItem="{Binding KeyboardJoystick}"
                                  IsEnabled="{Binding IsKeyboardJoystickSelectionEnabled}"
                                  Classes="small"
                                  MinWidth="30"/>
                    </Grid>

                    <Button Name ="C64Config"
                            Content="C64 Config"
                            Click="OpenC64Config_Click"
                            IsEnabled="{Binding IsC64ConfigEnabled}"
                            Classes="small">
                        <Button.Transitions>
                            <Transitions>
                                <BrushTransition Property="Background" Duration="0:0:0.7"/>
                            </Transitions>
                        </Button.Transitions>
                    </Button>

                </StackPanel>
            </Border>
        </StackPanel>

    </StackPanel>
</UserControl>